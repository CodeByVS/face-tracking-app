(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[845],{629:function(e,t,o){var r,n;void 0===(n="function"==typeof(r=function(){"use strict";function t(e,t,o){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){c(r.response,t,o)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(o){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof o.g&&o.g.global===o.g?o.g:void 0,l=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,o,l){var c=a.URL||a.webkitURL,s=document.createElement("a");s.download=o=o||e.name||"download",s.rel="noopener","string"==typeof e?(s.href=e,s.origin===location.origin?n(s):r(s.href)?t(e,o,l):n(s,s.target="_blank")):(s.href=c.createObjectURL(e),setTimeout(function(){c.revokeObjectURL(s.href)},4e4),setTimeout(function(){n(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,o,a){if(o=o||e.name||"download","string"!=typeof e){var l;navigator.msSaveOrOpenBlob((void 0===(l=a)?l={autoBom:!1}:"object"!=typeof l&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e),o)}else if(r(e))t(e,o,a);else{var c=document.createElement("a");c.href=e,c.target="_blank",setTimeout(function(){n(c)})}}:function(e,o,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,o,r);var c="application/octet-stream"===e.type,s=/constructor/i.test(a.HTMLElement)||a.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||c&&s||l)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},d.readAsDataURL(e)}else{var u=a.URL||a.webkitURL,f=u.createObjectURL(e);n?n.location=f:location.href=f,n=null,setTimeout(function(){u.revokeObjectURL(f)},4e4)}});a.saveAs=c.saveAs=c,e.exports=c})?r.apply(t,[]):r)||(e.exports=n)},1808:()=>{},2487:()=>{},2859:(e,t,o)=>{"use strict";o.d(t,{A6:()=>a,Mh:()=>l,q1:()=>n});var r=o(7598);async function n(){let e="./models";try{console.log("[Model Loader] Starting model loading from: ".concat(e)),console.log("[Model Loader] Current environment: production"),console.log("[Model Loader] Verifying model files...");let t=["".concat(e,"/tiny_face_detector_model-weights_manifest.json"),"".concat(e,"/face_landmark_68_model-weights_manifest.json")];console.log("[Model Loader] Checking model manifests at:",t);let o=await Promise.allSettled(t.map(e=>fetch(e).then(e=>{if(!e.ok)throw Error("HTTP ".concat(e.status," ").concat(e.statusText));return e.json()})));o.forEach((e,o)=>{"fulfilled"===e.status?console.log("[Model Loader] Successfully loaded manifest: ".concat(t[o])):console.error("[Model Loader] Failed to load manifest ".concat(t[o],":"),e.reason)});let n=o.filter(e=>"rejected"===e.status);if(n.length>0)throw Error("Failed to load ".concat(n.length," model manifest(s). Check console for details."));let a=async function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=null;for(let n=1;n<=o;n++)try{return console.log("[Model Loader] Loading ".concat(t," (attempt ").concat(n,"/").concat(o,")...")),await e(),console.log("[Model Loader] ".concat(t," loaded successfully")),!0}catch(e){r=e,console.warn("[Model Loader] Attempt ".concat(n," failed for ").concat(t,":"),e),n<o&&await new Promise(e=>setTimeout(e,1e3*n))}throw r||Error("Failed to load ".concat(t," after ").concat(o," attempts"))};return await a(()=>r.B0.tinyFaceDetector.loadFromUri(e),"TinyFaceDetector"),await a(()=>r.B0.faceLandmark68Net.loadFromUri(e),"FaceLandmark68Net"),console.log("[Model Loader] All models loaded successfully"),!0}catch(t){if(console.error("[Model Loader] Error loading models:",t),console.log("[Model Loader] Current URL:",window.location.href),console.log("[Model Loader] Current path:",window.location.pathname),console.log("[Model Loader] Model path:",e),console.log("[Model Loader] Environment:","production"),t instanceof Error)throw(t.message.includes("Failed to fetch")||t.message.includes("404"))&&(console.error("[Model Loader] Network error - the model files could not be loaded."),console.error("[Model Loader] Please check if the model files exist in the public/models directory.")),Error("Failed to load face detection models: ".concat(t.message));throw Error("An unknown error occurred while loading models")}}function a(){try{var e,t,o,n;let a=null!=(o=null==(e=r.B0.tinyFaceDetector)?void 0:e.isLoaded)&&o,l=null!=(n=null==(t=r.B0.faceLandmark68Net)?void 0:t.isLoaded)&&n;return a&&l||console.warn("[Model Loader] Some models are not loaded:",{tinyFaceDetector:a,faceLandmark68Net:l}),a&&l}catch(e){return console.error("[Model Loader] Error checking if models are loaded:",e),!1}}function l(){return{basePath:"./models",tinyFaceDetector:"".concat("./models","/tiny_face_detector_model-weights_manifest.json"),faceLandmark68:"".concat("./models","/face_landmark_68_model-weights_manifest.json")}}},4907:()=>{},8984:()=>{},9445:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>s});var r=o(2273),n=o(5461),a=o(7598),l=o(629),c=o(2859);function s(){let e=(0,n.useRef)(null),t=(0,n.useRef)(null),[o,s]=(0,n.useState)(!1),[i,d]=(0,n.useState)(!0),[u,f]=(0,n.useState)(null),m=(0,n.useRef)(null),g=(0,n.useRef)([]),h=(0,n.useRef)(null),w=(0,n.useCallback)(async()=>{let o=e.current,r=t.current;if(!o||!r||o.paused||o.ended){h.current=requestAnimationFrame(w);return}let n=r.getContext("2d");if(n){let e={width:r.width,height:r.height};a.L0(r,e),n.drawImage(o,0,0,r.width,r.height);let t=await a.R(o,new a.ex);a.Lz(t,e).forEach(e=>{let t=e.box;new a.$2.UT(t,{label:"Face",lineWidth:2,boxColor:"rgba(0, 255, 0, 1)"}).draw(r)})}h.current=requestAnimationFrame(w)},[]),p=(0,n.useCallback)(async()=>{try{let o=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480,facingMode:"user"},audio:!1});e.current&&(e.current.srcObject=o,e.current.onloadedmetadata=()=>{if(e.current&&t.current){let o=e.current,r=t.current;r.width=o.videoWidth,r.height=o.videoHeight,o.onplay=()=>{w()},o.play()}})}catch(e){f("Could not access camera. Please ensure you have granted camera permissions."),console.error(e)}},[w]);(0,n.useEffect)(()=>{(async()=>{try{console.log("Starting to load face detection models...");try{if(await (0,c.q1)(),(0,c.A6)())console.log("All models loaded successfully, starting video..."),d(!1),p();else throw Error("Models did not load correctly")}catch(t){console.error("Error loading models:",t);let e=t instanceof Error?t.message:"Unknown error occurred";f("Failed to load face detection models: ".concat(e,". Check the browser console for more details."))}}catch(t){console.error("Unexpected error in model loading:",t);let e=t instanceof Error?t.message:"Unknown error occurred";f("An unexpected error occurred: ".concat(e))}})();let t=e.current;return()=>{h.current&&cancelAnimationFrame(h.current),t&&t.srcObject&&t.srcObject.getTracks().forEach(e=>e.stop())}},[p]);let v=async e=>{let t=Date.now(),o="face-tracking-".concat(new Date(t).toISOString(),".webm");try{let r=JSON.parse(localStorage.getItem("faceTrackingVideos")||"[]");r.push({id:"video-".concat(t),filename:o,timestamp:t,size:e.size});let n=r.slice(-10);localStorage.setItem("faceTrackingVideos",JSON.stringify(n)),(0,l.saveAs)(e,o),alert("Video saved successfully and downloaded to your device.")}catch(t){console.error("Error saving video:",t),(0,l.saveAs)(e,o),alert("Video downloaded. Could not save to browser storage.")}};return u?(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsxs)("div",{className:"text-red-500 text-center p-4",children:[(0,r.jsx)("p",{children:u}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Try Again"})]})}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col items-center justify-center p-4",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Face Tracking App"}),(0,r.jsxs)("div",{className:"relative w-full max-w-2xl mx-auto",children:[i&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 z-20",children:(0,r.jsx)("p",{className:"text-lg",children:"Loading Models..."})}),(0,r.jsx)("video",{ref:e,className:"w-full h-auto rounded-lg shadow-lg",autoPlay:!0,muted:!0,playsInline:!0}),(0,r.jsx)("canvas",{ref:t,className:"absolute top-0 left-0 w-full h-full z-10 rounded-lg"})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("button",{onClick:()=>{o?m.current&&"inactive"!==m.current.state&&(m.current.stop(),s(!1)):(()=>{if(!t.current)return;let e=t.current.captureStream(30);g.current=[],m.current=new MediaRecorder(e,{mimeType:"video/webm;codecs=vp9"}),m.current.ondataavailable=e=>{e.data.size>0&&g.current.push(e.data)},m.current.onstop=()=>{v(new Blob(g.current,{type:"video/webm"}))},m.current.start(),s(!0)})()},disabled:i,className:"px-6 py-3 rounded-lg text-lg font-semibold transition-colors duration-300 ".concat(o?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"," disabled:bg-gray-500 disabled:cursor-not-allowed"),children:o?"Stop Recording":"Start Recording"})})]})}}}]);